# フェーズ3: 家具配置・管理 - 操作手順書

## 前提条件
- フェーズ2までのセットアップが完了していること
- Docker環境が起動していること（`docker-compose up`）
- プロジェクトが1つ以上作成されていること

## 1. 家具配置の基本操作

### エディタを開く
1. ダッシュボードでプロジェクトの「編集する」ボタンをクリック
2. エディタページが開く

### 家具を配置する
1. 左側ツールバーの「家具配置」ボタンをクリック
2. 右側に家具カタログサイドバーが表示される
3. カタログからカテゴリ別に家具を選択（例: シングルベッド）
4. キャンバス上の配置したい位置をクリック
5. 家具が配置される

### 家具を移動する
1. 「選択」または「家具配置」ツールを選択
2. 配置済みの家具をドラッグして移動
3. 家具は部屋の範囲内に制限される

### 家具を回転する
1. 配置済みの家具をクリックして選択
2. 右下のプロパティパネルが表示される
3. 「90°回転」ボタンをクリック（0° → 90° → 180° → 270°）

### 家具を削除する
1. 削除したい家具をクリックして選択
2. プロパティパネルの「削除」ボタンをクリック

### 選択を解除する
- キャンバスの空白部分をクリック
- プロパティパネルの × ボタンをクリック

## 2. 家具カタログ

### カテゴリ一覧
| カテゴリ | 家具 |
|---------|------|
| ベッド・寝具 | シングルベッド、セミダブルベッド、ダブルベッド、布団 |
| ソファ・椅子 | 2人掛けソファ、3人掛けソファ、椅子 |
| テーブル・デスク | ダイニングテーブル(4人/6人)、デスク、ローテーブル、こたつ |
| 収納 | ワードローブ、本棚、チェスト、テレビ台 |
| 家電 | テレビ、冷蔵庫、洗濯機 |

### サイズについて
- カタログに表示されるサイズは一般的な日本の家具サイズ
- サイズは「幅 x 奥行き」で表示（単位: cm）
- 内部ではmm単位で管理

## 3. 自動保存

- 家具の配置・移動・回転・削除から2秒後に自動保存
- ページをリロードしてもデータが復元される
- ネットワークエラー時はコンソールにエラーが表示される

## 4. プロパティパネル

家具を選択すると右下に表示される情報:
- **家具名**: 選択した家具の名前
- **位置**: X座標、Y座標（cm）
- **サイズ**: 幅 x 奥行き（cm）
- **角度**: 現在の回転角度

## 5. 他のツールとの共存

- 壁描画ツール使用中は家具の操作不可
- 移動ツールでキャンバスをパン可能
- グリッド表示のON/OFFは全ツールで有効
- ズーム（マウスホイール）は全ツールで有効

## 6. API（開発者向け）

### 家具データの保存
```bash
TOKEN="..."
curl -X PUT http://localhost:3000/api/projects/{id} \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer $TOKEN" \
  -d '{
    "furnitureData": [
      {
        "id": "uuid",
        "type": "bed_single",
        "name": "シングルベッド",
        "x": 3000,
        "y": 2000,
        "widthMm": 970,
        "heightMm": 1950,
        "rotation": 0,
        "color": "#93c5fd"
      }
    ]
  }'
```

## 7. トラブルシューティング

### 家具が配置できない
- 「家具配置」ツールが選択されているか確認
- カタログから家具が選択されているか確認（青い枠線）
- キャンバスの部屋の範囲内をクリックしているか確認

### 家具が動かない
- 「選択」または「家具配置」ツールが選択されているか確認
- 「壁描画」や「移動」ツールでは家具のドラッグ不可

### 保存されない
- ブラウザのネットワークタブでPUTリクエストを確認
- バックエンドログ: `docker-compose logs backend`
- ログインセッションが有効か確認
